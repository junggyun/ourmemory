{"version":3,"file":"js/329.10896492.js","mappings":"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","sources":["webpack://ourmemory/./src/views/LoginView.vue?448a","webpack://ourmemory/./src/views/LoginView.vue"],"sourcesContent":["import { defineComponent as _defineComponent } from 'vue'\nimport { createElementVNode as _createElementVNode, withKeys as _withKeys, vModelText as _vModelText, withDirectives as _withDirectives, vShow as _vShow, openBlock as _openBlock, createElementBlock as _createElementBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-01176575\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"main\" }\nconst _hoisted_2 = { class: \"form\" }\nconst _hoisted_3 = { id: \"emailInput\" }\nconst _hoisted_4 = [\"onKeyup\"]\nconst _hoisted_5 = {\n  class: \"input-error\",\n  style: {\"color\":\"red\"}\n}\nconst _hoisted_6 = { id: \"passwordInput\" }\nconst _hoisted_7 = [\"onKeyup\"]\n\nimport router from \"@/router\";\r\nimport {ref} from \"vue\"\r\nimport jwtDecode from \"jwt-decode\";\r\nimport store from \"@/store\";\r\nimport {loginAPI} from \"@/api\";\r\n\r\ninterface MyPayload {\r\n    sub: String\r\n    auth: String\r\n    email: String,\r\n    name: String,\r\n    nickName: String,\r\n    createdDate: String,\r\n    exp: number\r\n}\r\n\r\n\nexport default /*#__PURE__*/_defineComponent({\n  name: 'LoginView',\n  setup(__props) {\n\r\nconst email = ref(\"\")\r\nconst password = ref(\"\")\r\nconst valid = ref(false)\r\n\r\nconst login = async function () {\r\n    try {\r\n        const loginRequest ={\r\n            email: email.value,\r\n            password: password.value\r\n        }\r\n        const res = await loginAPI(loginRequest);\r\n        const token = res.data.accessToken\r\n        const refreshToken = res.data.refreshToken\r\n        const tokenExp = jwtDecode<MyPayload>(token).exp\r\n        const userId = jwtDecode<MyPayload>(token).sub\r\n        const userName = jwtDecode<MyPayload>(token).name\r\n        const userNickName = jwtDecode<MyPayload>(token).nickName\r\n        const createdDate = jwtDecode<MyPayload>(token).createdDate\r\n        const role = jwtDecode<MyPayload>(token).auth\r\n        const refreshTokenExp = jwtDecode<MyPayload>(refreshToken).exp\r\n\r\n        store.commit('setUserId', userId)\r\n        store.commit('setRole', role)\r\n        store.commit('setToken', token)\r\n        store.commit('setTokenExp', tokenExp)\r\n        store.commit('setRefreshToken', refreshToken)\r\n        store.commit('setRefreshTokenExp', refreshTokenExp)\r\n\r\n        store.commit('setEmail', loginRequest.email)\r\n        store.commit('setUserName', userName)\r\n        store.commit('setUserNickName', userNickName)\r\n        store.commit('setUserCreatedDate', createdDate)\r\n\r\n        if (role === \"ROLE_ADMIN\") {\r\n            await router.replace('/admin')\r\n        } else if (role === \"ROLE_USER\") {\r\n            if (userId.toString() != '0') {\r\n                await router.replace(`/${userId}/home`);\r\n            }\r\n        }\r\n    } catch (err) {\r\n        valid.value = true\r\n        console.log(err)\r\n    }\r\n\r\n}\r\n\r\nconst loginPage = function () {\r\n    router.push(\"/\")\r\n    console.log(process.env)\r\n}\r\n\r\nconst goSignup = function () {\r\n    router.push(\"/signup\")\r\n}\r\n\r\nconst handleEmailInput = function (e: any) {\r\n    e.target.value = e.target.value.replace(/[^A-Za-z0-9@.]/ig, '')\r\n};\r\n\r\n\r\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createElementVNode(\"div\", _hoisted_2, [\n      _createElementVNode(\"div\", { class: \"title\" }, [\n        _createElementVNode(\"h1\", { onClick: loginPage }, \"OurMemory\")\n      ]),\n      _createElementVNode(\"div\", _hoisted_3, [\n        _withDirectives(_createElementVNode(\"input\", {\n          class: \"form-control form-control-lg\",\n          type: \"email\",\n          placeholder: \"이메일\",\n          onKeyup: _withKeys(login, [\"enter\"]),\n          \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((email).value = $event)),\n          onInput: handleEmailInput,\n          \"aria-label\": \".form-control-lg example\"\n        }, null, 40, _hoisted_4), [\n          [_vModelText, email.value]\n        ]),\n        _withDirectives(_createElementVNode(\"span\", _hoisted_5, \"이메일 또는 비밀번호를 다시 확인해주세요.\", 512), [\n          [_vShow, valid.value]\n        ])\n      ]),\n      _createElementVNode(\"div\", _hoisted_6, [\n        _withDirectives(_createElementVNode(\"input\", {\n          class: \"form-control form-control-lg\",\n          type: \"password\",\n          placeholder: \"비밀번호\",\n          \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event: any) => ((password).value = $event)),\n          minlength: 8,\n          maxlength: 16,\n          onKeyup: _withKeys(login, [\"enter\"]),\n          \"aria-label\": \".form-control-lg example\"\n        }, null, 40, _hoisted_7), [\n          [_vModelText, password.value]\n        ])\n      ]),\n      _createElementVNode(\"div\", { id: \"loginButton\" }, [\n        _createElementVNode(\"div\", { class: \"d-grid gap-2\" }, [\n          _createElementVNode(\"button\", {\n            type: \"button\",\n            onClick: login,\n            class: \"btn btn-secondary btn-lg\"\n          }, \"로그인\")\n        ])\n      ]),\n      _createElementVNode(\"div\", { id: \"signupButton\" }, [\n        _createElementVNode(\"div\", { class: \"d-grid gap-2\" }, [\n          _createElementVNode(\"button\", {\n            type: \"button\",\n            onClick: goSignup,\n            class: \"btn btn-secondary btn-lg\"\n          }, \"계정 만들기\")\n        ])\n      ])\n    ])\n  ]))\n}\n}\n\n})","import script from \"./LoginView.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./LoginView.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./LoginView.vue?vue&type=style&index=0&id=01176575&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-01176575\"]])\n\nexport default __exports__"],"names":["_hoisted_1","class","_hoisted_2","_hoisted_3","id","_hoisted_4","_hoisted_5","style","_hoisted_6","_hoisted_7","_defineComponent","name","setup","__props","email","ref","password","valid","login","async","loginRequest","value","res","loginAPI","token","data","accessToken","refreshToken","tokenExp","jwtDecode","exp","userId","sub","userName","userNickName","nickName","createdDate","role","auth","refreshTokenExp","store","router","toString","err","console","log","loginPage","process","goSignup","handleEmailInput","e","target","replace","_ctx","_cache","_openBlock","_createElementBlock","_createElementVNode","onClick","_withDirectives","type","placeholder","onKeyup","_withKeys","$event","onInput","_vModelText","_vShow","minlength","maxlength","__exports__"],"sourceRoot":""}